<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit lasso penalized regression path for big data — biglasso • biglasso</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit lasso penalized regression path for big data — biglasso" />
<meta property="og:description" content="Extend lasso model fitting to big data that cannot be loaded into memory.
Fit solution paths for linear, logistic or Cox regression models penalized by
lasso, ridge, or elastic-net over a grid of values for the regularization
parameter lambda." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biglasso</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/biglasso.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/YaohuiZeng/biglasso/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit lasso penalized regression path for big data</h1>
    <small class="dont-index">Source: <a href='https://github.com/YaohuiZeng/biglasso/blob/master/R/biglasso.R'><code>R/biglasso.R</code></a></small>
    <div class="hidden name"><code>biglasso.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extend lasso model fitting to big data that cannot be loaded into memory.
Fit solution paths for linear, logistic or Cox regression models penalized by
lasso, ridge, or elastic-net over a grid of values for the regularization
parameter lambda.</p>
    </div>

    <pre class="usage"><span class='fu'>biglasso</span><span class='op'>(</span>
  <span class='va'>X</span>,
  <span class='va'>y</span>,
  row.idx <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>,
  penalty <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"lasso"</span>, <span class='st'>"ridge"</span>, <span class='st'>"enet"</span><span class='op'>)</span>,
  family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"gaussian"</span>, <span class='st'>"binomial"</span>, <span class='st'>"cox"</span>, <span class='st'>"mgaussian"</span><span class='op'>)</span>,
  alg.logistic <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Newton"</span>, <span class='st'>"MM"</span><span class='op'>)</span>,
  screen <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Adaptive"</span>, <span class='st'>"SSR"</span>, <span class='st'>"Hybrid"</span>, <span class='st'>"None"</span><span class='op'>)</span>,
  safe.thresh <span class='op'>=</span> <span class='fl'>0</span>,
  update.thresh <span class='op'>=</span> <span class='fl'>1</span>,
  ncores <span class='op'>=</span> <span class='fl'>1</span>,
  alpha <span class='op'>=</span> <span class='fl'>1</span>,
  lambda.min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>, <span class='fl'>0.001</span>, <span class='fl'>0.05</span><span class='op'>)</span>,
  nlambda <span class='op'>=</span> <span class='fl'>100</span>,
  lambda.log.scale <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>lambda</span>,
  eps <span class='op'>=</span> <span class='fl'>1e-07</span>,
  max.iter <span class='op'>=</span> <span class='fl'>1000</span>,
  dfmax <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span>,
  penalty.factor <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span><span class='op'>)</span>,
  warn <span class='op'>=</span> <span class='cn'>TRUE</span>,
  output.time <span class='op'>=</span> <span class='cn'>FALSE</span>,
  return.time <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>The design matrix, without an intercept. It must be a
double type <code><a href='https://rdrr.io/pkg/bigmemory/man/big.matrix.html'>big.matrix</a></code> object. The function
standardizes the data and includes an intercept internally by default during
the model fitting.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>The response vector for <code>family="gaussian"</code> or <code>family="binomial"</code>.
For <code>family="cox"</code>, <code>y</code> should be a two-column matrix with columns
'time' and 'status'. The latter is a binary variable, with '1' indicating death,
 and '0' indicating right censored. For <code>family="mgaussin"</code>, <code>y</code>
 should be a n*m matrix where n is the sample size and m is the number of
 responses.</p></td>
    </tr>
    <tr>
      <th>row.idx</th>
      <td><p>The integer vector of row indices of <code>X</code> that used for
fitting the model. <code>1:nrow(X)</code> by default.</p></td>
    </tr>
    <tr>
      <th>penalty</th>
      <td><p>The penalty to be applied to the model. Either <code>"lasso"</code>
(the default), <code>"ridge"</code>, or <code>"enet"</code> (elastic net).</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Either <code>"gaussian"</code>, <code>"binomial"</code>, <code>"cox"</code> or
<code>"mgaussian"</code> depending on the response.</p></td>
    </tr>
    <tr>
      <th>alg.logistic</th>
      <td><p>The algorithm used in logistic regression. If "Newton"
then the exact hessian is used (default); if "MM" then a
majorization-minimization algorithm is used to set an upper-bound on the
hessian matrix. This can be faster, particularly in data-larger-than-RAM
case.</p></td>
    </tr>
    <tr>
      <th>screen</th>
      <td><p>The feature screening rule used at each <code>lambda</code> that
discards features to speed up computation: <code>"SSR"</code> (default if
<code>penalty="ridge"</code> or <code>penalty="enet"</code> )is the sequential strong rule;
<code>"Hybrid"</code> is our newly proposed hybrid screening rules which combine the
strong rule with a safe rule. <code>"Adaptive"</code> (default for <code>penalty="lasso"</code>
without <code>penalty.factor</code>) is our newly proposed adaptive rules which
reuse screening reference for multiple lambda values. <strong>Note that:</strong>
(1) for linear regression with elastic net penalty, both <code>"SSR"</code> and
<code>"Hybrid"</code> are applicable since version 1.3-0;  (2) only <code>"SSR"</code> is
applicable to elastic-net-penalized logistic regression or cox regression;
(3) active set cycling strategy is incorporated with these screening rules.</p></td>
    </tr>
    <tr>
      <th>safe.thresh</th>
      <td><p>the threshold value between 0 and 1 that controls when to
stop safe test. For example, 0.01 means to stop safe test at next lambda 
iteration if the number of features rejected by safe test at current lambda
iteration is not larger than 1% of the total number of features. So 1 means
to always turn off safe test, whereas 0 (default) means to turn off safe test
if the number of features rejected by safe test is 0 at current lambda.</p></td>
    </tr>
    <tr>
      <th>update.thresh</th>
      <td><p>the non negative threshold value that controls how often to
update the reference of safe rules for "Adaptive" methods. Smaller value means
updating more often.</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>The number of OpenMP threads used for parallel computing.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>The elastic-net mixing parameter that controls the relative
contribution from the lasso (l1) and the ridge (l2) penalty. The penalty is
defined as $$ \alpha||\beta||_1 + (1-\alpha)/2||\beta||_2^2.$$
<code>alpha=1</code> is the lasso penalty, <code>alpha=0</code> the ridge penalty,
<code>alpha</code> in between 0 and 1 is the elastic-net ("enet") penalty.</p></td>
    </tr>
    <tr>
      <th>lambda.min</th>
      <td><p>The smallest value for lambda, as a fraction of
lambda.max.  Default is .001 if the number of observations is larger than
the number of covariates and .05 otherwise.</p></td>
    </tr>
    <tr>
      <th>nlambda</th>
      <td><p>The number of lambda values.  Default is 100.</p></td>
    </tr>
    <tr>
      <th>lambda.log.scale</th>
      <td><p>Whether compute the grid values of lambda on log
scale (default) or linear scale.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>A user-specified sequence of lambda values.  By default, a
sequence of values of length <code>nlambda</code> is computed, equally spaced on
the log scale.</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>Convergence threshold for inner coordinate descent.  The
algorithm iterates until the maximum change in the objective after any
coefficient update is less than <code>eps</code> times the null deviance. Default
value is <code>1e-7</code>.</p></td>
    </tr>
    <tr>
      <th>max.iter</th>
      <td><p>Maximum number of iterations.  Default is 1000.</p></td>
    </tr>
    <tr>
      <th>dfmax</th>
      <td><p>Upper bound for the number of nonzero coefficients.  Default is
no upper bound.  However, for large data sets, computational burden may be
heavy for models with a large number of nonzero coefficients.</p></td>
    </tr>
    <tr>
      <th>penalty.factor</th>
      <td><p>A multiplicative factor for the penalty applied to
each coefficient. If supplied, <code>penalty.factor</code> must be a numeric
vector of length equal to the number of columns of <code>X</code>.  The purpose of
<code>penalty.factor</code> is to apply differential penalization if some
coefficients are thought to be more likely than others to be in the model.
Current package doesn't allow unpenalized coefficients. That
is<code>penalty.factor</code> cannot be 0. <code>penalty.factor</code> is only supported
for "SSR" screen.</p></td>
    </tr>
    <tr>
      <th>warn</th>
      <td><p>Return warning messages for failures to converge and model
saturation?  Default is TRUE.</p></td>
    </tr>
    <tr>
      <th>output.time</th>
      <td><p>Whether to print out the start and end time of the model
fitting. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>return.time</th>
      <td><p>Whether to return the computing time of the model
fitting. Default is TRUE.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Whether to output the timing of each lambda iteration.
Default is FALSE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object with S3 class <code>"biglasso"</code> for
<code>"gaussian", "binomial", "cox"</code> families, or an object with S3 class
<code>"mbiglasso"</code> for <code>"mgaussian"</code> family,  with following variables.</p>
<dt>beta</dt><dd><p>The fitted matrix of coefficients, store in sparse matrix
representation. The number of rows is equal to the number of coefficients,
whereas the number of columns is equal to <code>nlambda</code>. For <code>"mgaussian"</code>
family with m responses, it is a list of m such matrices.</p></dd> 
<dt>iter</dt><dd><p>A vector of length <code>nlambda</code> containing the number of 
iterations until convergence at each value of <code>lambda</code>.</p></dd> 
<dt>lambda</dt><dd><p>The sequence of regularization parameter values in the path.</p></dd>
<dt>penalty</dt><dd><p>Same as above.</p></dd>
<dt>family</dt><dd><p>Same as above.</p></dd>
<dt>alpha</dt><dd><p>Same as above.</p></dd> 
<dt>loss</dt><dd><p>A vector containing either the residual sum of squares 
(for <code>"gaussian", "mgaussian"</code>) or negative log-likelihood
(for <code>"binomial", "cox"</code>) of the fitted model at each value of <code>lambda</code>.</p></dd>
<dt>penalty.factor</dt><dd><p>Same as above.</p></dd>
<dt>n</dt><dd><p>The number of observations used in the model fitting. It's equal to
<code><a href='https://rdrr.io/r/base/length.html'>length(row.idx)</a></code>.</p></dd> 
<dt>center</dt><dd><p>The sample mean vector of the variables, i.e., column mean of
the sub-matrix of <code>X</code> used for model fitting.</p></dd> 
<dt>scale</dt><dd><p>The sample standard deviation of the variables, i.e., column
standard deviation of the sub-matrix of <code>X</code> used for model fitting.</p></dd> 
<dt>y</dt><dd><p>The response vector used in the model fitting. Depending on
<code>row.idx</code>, it could be a subset of the raw input of the response vector y.</p></dd>
<dt>screen</dt><dd><p>Same as above.</p></dd> 
<dt>col.idx</dt><dd><p>The indices of features that have 'scale' value greater than
1e-6. Features with 'scale' less than 1e-6 are removed from model fitting.</p></dd> 
<dt>rejections</dt><dd><p>The number of features rejected at each value of <code>lambda</code>.</p></dd>
<dt>safe_rejections</dt><dd><p>The number of features rejected by safe rules at each
value of <code>lambda</code>.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The objective function for linear regression or multiple responses linear regression 
(<code>family = "gaussian"</code> or <code>family = "mgaussian"</code>) is
$$\frac{1}{2n}\textrm{RSS} + \lambda*\textrm{penalty},$$
where for <code>family = "mgaussian"</code>), a group-lasso type penalty is applied.
For logistic regression
(<code>family = "binomial"</code>) it is $$-\frac{1}{n} loglike +
\lambda*\textrm{penalty},$$, for cox regression,
 breslow approximation for ties is applied.</p>
<p>Several advanced feature screening rules are implemented. For
lasso-penalized linear regression, all the options of <code>screen</code> are
applicable. Our proposal adaptive rule - <code>"Adaptive"</code> - achieves highest speedup
so it's the recommended one, especially for ultrahigh-dimensional large-scale
data sets. For cox regression and/or the elastic net penalty, only
<code>"SSR"</code> is applicable for now. More efficient rules are under development.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='biglasso-package.html'>biglasso-package</a></code>, <code><a href='setupX.html'>setupX</a></code>,
<code><a href='cv.biglasso.html'>cv.biglasso</a></code>, <code><a href='plot.biglasso.html'>plot.biglasso</a></code>,
<code><a href='http://pbreheny.github.io/ncvreg/reference/ncvreg.html'>ncvreg</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Yaohui Zeng, Chuyi Wang and Patrick Breheny</p>
<p>Maintainer: Yaohui Zeng &lt;yaohui.zeng@gmail.com&gt; and Chuyi Wang &lt;wwaa0208@gmail.com&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Linear regression</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>colon</span><span class='op'>)</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='va'>colon</span><span class='op'>$</span><span class='va'>X</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>colon</span><span class='op'>$</span><span class='va'>y</span>
<span class='va'>X.bm</span> <span class='op'>&lt;-</span> <span class='fu'>as.big.matrix</span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>
<span class='co'># lasso, default</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>fit.lasso</span> <span class='op'>&lt;-</span> <span class='fu'>biglasso</span><span class='op'>(</span><span class='va'>X.bm</span>, <span class='va'>y</span>, family <span class='op'>=</span> <span class='st'>'gaussian'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit.lasso</span>, log.l <span class='op'>=</span> <span class='cn'>TRUE</span>, main <span class='op'>=</span> <span class='st'>'lasso'</span><span class='op'>)</span>
<span class='co'># elastic net</span>
<span class='va'>fit.enet</span> <span class='op'>&lt;-</span> <span class='fu'>biglasso</span><span class='op'>(</span><span class='va'>X.bm</span>, <span class='va'>y</span>, penalty <span class='op'>=</span> <span class='st'>'enet'</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span>, family <span class='op'>=</span> <span class='st'>'gaussian'</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit.enet</span>, log.l <span class='op'>=</span> <span class='cn'>TRUE</span>, main <span class='op'>=</span> <span class='st'>'elastic net, alpha = 0.5'</span><span class='op'>)</span>
</div><div class='img'><img src='biglasso-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Logistic regression</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>colon</span><span class='op'>)</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='va'>colon</span><span class='op'>$</span><span class='va'>X</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>colon</span><span class='op'>$</span><span class='va'>y</span>
<span class='va'>X.bm</span> <span class='op'>&lt;-</span> <span class='fu'>as.big.matrix</span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>
<span class='co'># lasso, default</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>fit.bin.lasso</span> <span class='op'>&lt;-</span> <span class='fu'>biglasso</span><span class='op'>(</span><span class='va'>X.bm</span>, <span class='va'>y</span>, penalty <span class='op'>=</span> <span class='st'>'lasso'</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit.bin.lasso</span>, log.l <span class='op'>=</span> <span class='cn'>TRUE</span>, main <span class='op'>=</span> <span class='st'>'lasso'</span><span class='op'>)</span>
<span class='co'># elastic net</span>
<span class='va'>fit.bin.enet</span> <span class='op'>&lt;-</span> <span class='fu'>biglasso</span><span class='op'>(</span><span class='va'>X.bm</span>, <span class='va'>y</span>, penalty <span class='op'>=</span> <span class='st'>'enet'</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit.bin.enet</span>, log.l <span class='op'>=</span> <span class='cn'>TRUE</span>, main <span class='op'>=</span> <span class='st'>'elastic net, alpha = 0.5'</span><span class='op'>)</span>
</div><div class='img'><img src='biglasso-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Cox regression</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10101</span><span class='op'>)</span>
<span class='va'>N</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>; <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fl'>30</span>; <span class='va'>nzc</span> <span class='op'>&lt;-</span> <span class='va'>p</span><span class='op'>/</span><span class='fl'>3</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>N</span> <span class='op'>*</span> <span class='va'>p</span><span class='op'>)</span>, <span class='va'>N</span>, <span class='va'>p</span><span class='op'>)</span>
<span class='va'>beta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>nzc</span><span class='op'>)</span>
<span class='va'>fx</span> <span class='op'>&lt;-</span> <span class='va'>X</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='va'>nzc</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>%*%</span> <span class='va'>beta</span><span class='op'>/</span><span class='fl'>3</span>
<span class='va'>hx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>fx</span><span class='op'>)</span>
<span class='va'>ty</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Exponential.html'>rexp</a></span><span class='op'>(</span><span class='va'>N</span>, <span class='va'>hx</span><span class='op'>)</span>
<span class='va'>tcens</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>N</span>, prob <span class='op'>=</span> <span class='fl'>0.3</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>  <span class='co'># censoring indicator</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>time <span class='op'>=</span> <span class='va'>ty</span>, status <span class='op'>=</span> <span class='fl'>1</span> <span class='op'>-</span> <span class='va'>tcens</span><span class='op'>)</span>  <span class='co'># y &lt;- Surv(ty, 1 - tcens) with library(survival)</span>
<span class='va'>X.bm</span> <span class='op'>&lt;-</span> <span class='fu'>as.big.matrix</span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'>biglasso</span><span class='op'>(</span><span class='va'>X.bm</span>, <span class='va'>y</span>, family <span class='op'>=</span> <span class='st'>"cox"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit</span>, main <span class='op'>=</span> <span class='st'>"cox"</span><span class='op'>)</span>

<span class='co'>## Multiple responses linear regression</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>10101</span><span class='op'>)</span>
<span class='va'>n</span><span class='op'>=</span><span class='fl'>300</span>; <span class='va'>p</span><span class='op'>=</span><span class='fl'>300</span>; <span class='va'>m</span><span class='op'>=</span><span class='fl'>5</span>; <span class='va'>s</span><span class='op'>=</span><span class='fl'>10</span>; <span class='va'>b</span><span class='op'>=</span><span class='fl'>1</span>
<span class='va'>x</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>*</span> <span class='va'>p</span><span class='op'>)</span>, <span class='va'>n</span>, <span class='va'>p</span><span class='op'>)</span>
<span class='va'>beta</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='op'>-</span><span class='va'>b</span>,to<span class='op'>=</span><span class='va'>b</span>,length.out<span class='op'>=</span><span class='va'>s</span><span class='op'>*</span><span class='va'>m</span><span class='op'>)</span>,<span class='va'>s</span>,<span class='va'>m</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>=</span> <span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='va'>s</span><span class='op'>]</span> <span class='op'>%*%</span> <span class='va'>beta</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>*</span><span class='va'>m</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='va'>n</span>,<span class='va'>m</span><span class='op'>)</span>
<span class='va'>x.bm</span> <span class='op'>=</span> <span class='fu'>as.big.matrix</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='va'>fit</span> <span class='op'>=</span> <span class='fu'>biglasso</span><span class='op'>(</span><span class='va'>x.bm</span>, <span class='va'>y</span>, family <span class='op'>=</span> <span class='st'>"mgaussian"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>fit</span>, main <span class='op'>=</span> <span class='st'>"mgaussian"</span><span class='op'>)</span>
</div><div class='img'><img src='biglasso-3.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Chuyi Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


